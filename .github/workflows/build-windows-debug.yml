name: Build Windows (Debug)

on:
  workflow_dispatch:  # Manual trigger only

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Setup Flutter
      uses: subosito/flutter-action@v2
      with:
        flutter-version: '3.16.0'
    
    - name: Install Dependencies
      run: |
        choco install visualstudio2022community -y
        choco install windows-sdk-10.0 -y
        choco install cmake -y
    
    - name: Flutter doctor
      run: flutter doctor -v
    
    - name: Get packages
      run: flutter pub get
    
    - name: Debug - List files
      run: dir
    
    - name: Try to build
      run: flutter build windows --verbose
    
    - name: Check build folder
      run: |
        dir build
        dir build/windows 2>nul || echo "No windows folder"
        dir build/windows/runner 2>nul || echo "No runner folder"
    
    - name: Upload any artifacts
      uses: actions/upload-artifact@v4
      with:
        name: debug-output
        path: |
          flutter.log
          build/
        if-no-files-found: warn
